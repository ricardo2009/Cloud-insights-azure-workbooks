{
  "version": "Notebook/1.0",
  "items": [
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "<h1 style=\"color: #003366; background: linear-gradient(90deg,#e6f7ff,#b3c6e6); padding: 20px; border-radius: 12px; text-shadow: 0 2px 8px rgba(0,0,0,0.3); font-size: 2.5em; letter-spacing: 2px;\">üåå Azure Futurist Observability Center</h1>\n<p style=\"color:#003366; font-size:1.2em;\">Vis√£o centralizada, interativa e visualmente impactante de toda a sua nuvem Azure. KPIs, status, tend√™ncias e insights em tempo real, com navega√ß√£o intuitiva e legendas explicativas.\n</p>"
            },
            "name": "header-futurist"
          },
          {
            "type": 1,
            "content": {
              "json": "<div style=\"display:flex;align-items:center;justify-content:space-between;background:#e3f2fd;padding:10px 20px;border-radius:10px;margin-bottom:10px;\"><span style=\"font-size:1.1em;color:#003366;\"><b>Bem-vindo ao Futurist Workbook!</b> <span style=\"background:#ffd700;color:#003366;padding:2px 8px;border-radius:6px;font-size:0.9em;\">Novo</span></span><button onclick=\"window.open('https://learn.microsoft.com/azure/azure-monitor/essentials/workbooks-overview','_blank')\" style=\"background:#003366;color:#fff;border:none;padding:6px 16px;border-radius:6px;cursor:pointer;font-size:0.95em;\">Ajuda & Exemplos</button></div>"
            },
            "name": "header-onboarding"
          },
          {
            "type": 9,
            "content": {
              "version": "KqlParameterItem/1.0",
              "parameters": [
                {
                  "id": "199eea3c-8bcd-476b-9725-bd30f531678a",
                  "version": "KqlParameterItem/1.0",
                  "name": "Subscription",
                  "label": "Assinaturas",
                  "type": 6,
                  "isRequired": true,
                  "multiSelect": true,
                  "quote": "'",
                  "delimiter": ",",
                  "value": [],
                  "typeSettings": {
                    "additionalResourceOptions": ["value::all"],
                    "includeAll": true,
                    "showDefault": false
                  }
                },
                {
                  "id": "f41ba5f7-61b4-457e-8700-2e4e70d69264",
                  "version": "KqlParameterItem/1.0",
                  "name": "LogAnalyticsWorkspace",
                  "label": "Log Analytics Workspace",
                  "type": 5,
                  "isRequired": true,
                  "multiSelect": true,
                  "quote": "'",
                  "delimiter": ",",
                  "query": "where type =~ 'microsoft.operationalinsights/workspaces'\r\n| summarize by id, name\r\n| project id",
                  "crossComponentResources": ["value::all"],
                  "typeSettings": {
                    "additionalResourceOptions": ["value::all"],
                    "showDefault": false
                  },
                  "defaultValue": "value::all",
                  "queryType": 1,
                  "resourceType": "microsoft.resourcegraph/resources"
                },
                {
                  "id": "bd401b11-047b-4fa5-9a5d-6eef4d5195d4",
                  "version": "KqlParameterItem/1.0",
                  "name": "timerange",
                  "label": "Per√≠odo",
                  "type": 4,
                  "value": {
                    "durationMs": 3600000
                  },
                  "typeSettings": {
                    "selectableValues": [
                      { "durationMs": 60000, "displayText": "1 minuto" },
                      { "durationMs": 120000, "displayText": "2 minutos" },
                      { "durationMs": 180000, "displayText": "3 minutos" },
                      { "durationMs": 240000, "displayText": "4 minutos" },
                      { "durationMs": 300000, "displayText": "5 minutos" },
                      { "durationMs": 600000, "displayText": "10 minutos" },
                      { "durationMs": 1200000, "displayText": "20 minutos" },
                      { "durationMs": 1800000, "displayText": "30 minutos" },
                      { "durationMs": 3600000, "displayText": "1 hora" },
                      { "durationMs": 7200000, "displayText": "2 horas" },
                      { "durationMs": 14400000, "displayText": "4 horas" },
                      { "durationMs": 21600000, "displayText": "6 horas" },
                      { "durationMs": 43200000, "displayText": "12 horas" },
                      { "durationMs": 86400000, "displayText": "24 horas" },
                      { "durationMs": 172800000, "displayText": "48 horas" },
                      { "durationMs": 259200000, "displayText": "72 horas" }
                    ]
                  }
                },
                {
                  "id": "020e7777-4653-47df-b1bd-9871134e2458",
                  "version": "KqlParameterItem/1.0",
                  "name": "ResourceGroup",
                  "label": "Grupo de Recursos",
                  "type": 2,
                  "description": "Filtra recursos por grupo de recursos",
                  "isRequired": false,
                  "multiSelect": true,
                  "quote": "'",
                  "delimiter": ",",
                  "query": "resourcecontainers | where type =~ 'microsoft.resources/subscriptions/resourcegroups' | project name | order by name asc",
                  "crossComponentResources": ["{Subscription}"],
                  "typeSettings": {
                    "additionalResourceOptions": ["value::all"],
                    "showDefault": false
                  },
                  "defaultValue": "value::all",
                  "queryType": 1,
                  "resourceType": "microsoft.resourcegraph/resources"
                },
                {
                  "id": "eb7d46f3-9ceb-4e4f-b594-2a941e2dc7d6",
                  "version": "KqlParameterItem/1.0",
                  "name": "Location",
                  "label": "Regi√£o",
                  "type": 2,
                  "isRequired": false,
                  "multiSelect": true,
                  "quote": "'",
                  "delimiter": ",",
                  "query": "resources | distinct location | where isnotempty(location) | project location | order by location asc",
                  "crossComponentResources": ["{Subscription}"],
                  "typeSettings": {
                    "additionalResourceOptions": ["value::all"],
                    "showDefault": false
                  },
                  "defaultValue": "value::all",
                  "queryType": 1,
                  "resourceType": "microsoft.resourcegraph/resources"
                },
                {
                  "id": "3aa64ee8-1a47-4654-b6f5-2bc6a7d8c7d6",
                  "version": "KqlParameterItem/1.0",
                  "name": "TabMain",
                  "label": "Menu Principal",
                  "type": 1,
                  "isRequired": false,
                  "value": "Overview",
                  "typeSettings": {
                    "parameterMode": "navigation"
                  },
                  "criteriaData": [
                    { "criteriaContext": {"operator": "==", "value": "Overview" } },
                    { "criteriaContext": {"operator": "==", "value": "Networking" } },
                    { "criteriaContext": {"operator": "==", "value": "Apps" } },
                    { "criteriaContext": {"operator": "==", "value": "Data" } },
                    { "criteriaContext": {"operator": "==", "value": "Containers" } },
                    { "criteriaContext": {"operator": "==", "value": "AI" } },
                    { "criteriaContext": {"operator": "==", "value": "Security" } },
                    { "criteriaContext": {"operator": "==", "value": "Infra" } }
                  ]
                }
              ],
              "style": "pills",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces"
            },
            "name": "parameters-futurist"
          },
          {
            "type": 1,
            "content": {
              "json": "<div style=\"margin:10px 0 20px 0;display:flex;gap:10px;flex-wrap:wrap;\"><span style=\"background:#1976d2;color:#fff;padding:4px 12px;border-radius:8px;font-size:0.95em;\">üîÑ Atualiza√ß√£o autom√°tica ativada</span><span style=\"background:#ffd700;color:#003366;padding:4px 12px;border-radius:8px;font-size:0.95em;\">‚ö†Ô∏è KPIs em tempo real</span><span style=\"background:#d32f2f;color:#fff;padding:4px 12px;border-radius:8px;font-size:0.95em;\">üî• Alertas cr√≠ticos</span></div>"
            },
            "name": "badges-status"
          },
          {
            "type": 1,
            "content": {
              "json": "<div style=\"margin-bottom:10px;\"><b>Dica:</b> Passe o mouse sobre os √≠cones <span style=\"color:#1976d2;font-size:1.2em;\">‚ÑπÔ∏è</span> para ver explica√ß√µes r√°pidas sobre m√©tricas e gr√°ficos.</div>"
            },
            "name": "tooltip-info"
          },
          {
            "type": 11,
            "content": {
              "version": "LinkItem/1.0",
              "style": "tabs",
              "links": [
                {
                  "id": "2ac358af-2c49-4b04-9950-0273cbfe4886",
                  "cellValue": "TabMain",
                  "linkTarget": "parameter",
                  "linkLabel": "üåê Vis√£o Geral",
                  "subTarget": "Overview",
                  "style": "primary",
                  "icon": "Dashboard",
                  "hoverText": "Vis√£o geral de todos os recursos do Azure"
                },
                {
                  "id": "911c3304-600a-42dc-9494-7a6385802a08",
                  "cellValue": "TabMain",
                  "linkTarget": "parameter",
                  "linkLabel": "üï∏Ô∏è Networking",
                  "subTarget": "Networking",
                  "style": "primary",
                  "icon": "Connect",
                  "hoverText": "An√°lise detalhada de recursos de rede"
                },
                {
                  "id": "4cf1773e-4562-40be-8011-94146094c124",
                  "cellValue": "TabMain",
                  "linkTarget": "parameter",
                  "linkLabel": "üß© Apps",
                  "subTarget": "Apps",
                  "style": "primary",
                  "icon": "WebApp",
                  "hoverText": "M√©tricas de aplica√ß√µes web e servi√ßos"
                },
                {
                  "id": "4aa57b90-2f60-4680-9afa-c2bc96548e32",
                  "cellValue": "TabMain",
                  "linkTarget": "parameter",
                  "linkLabel": "üóÑÔ∏è Dados",
                  "subTarget": "Data",
                  "style": "primary",
                  "icon": "Database",
                  "hoverText": "Bancos de dados e servi√ßos de armazenamento"
                },
                {
                  "id": "3bfb312c-6489-46a3-b7bd-c34dd3d43f8b",
                  "cellValue": "TabMain",
                  "linkTarget": "parameter",
                  "linkLabel": "üì¶ Containers",
                  "subTarget": "Containers",
                  "style": "primary",
                  "icon": "Container",
                  "hoverText": "AKS, ARO e outros servi√ßos de cont√™ineres"
                },
                {
                  "id": "2f85c4b2-1dd5-4707-ad4a-ec4da2a41c89",
                  "cellValue": "TabMain",
                  "linkTarget": "parameter",
                  "linkLabel": "üß† IA & ML",
                  "subTarget": "AI",
                  "style": "primary",
                  "icon": "CognitiveServicesAI",
                  "hoverText": "Servi√ßos de IA, ML e an√°lise avan√ßada"
                },
                {
                  "id": "e98cdde2-8a5c-4027-8644-2cbb0b99ffd7",
                  "cellValue": "TabMain",
                  "linkTarget": "parameter",
                  "linkLabel": "üõ°Ô∏è Seguran√ßa",
                  "subTarget": "Security",
                  "style": "primary",
                  "icon": "Lock",
                  "hoverText": "Seguran√ßa e conformidade"
                },
                {
                  "id": "9f9e1493-f000-4762-8819-baf41c8fdde3",
                  "cellValue": "TabMain",
                  "linkTarget": "parameter",
                  "linkLabel": "üèóÔ∏è Infraestrutura",
                  "subTarget": "Infra",
                  "style": "primary",
                  "icon": "Columns",
                  "hoverText": "Infraestrutura b√°sica e outros recursos"
                }
              ]
            },
            "customWidth": "100",
            "name": "tabs-futurist"
          },
          {
            "type": 1,
            "content": {
              "json": "<div style=\"border-left: 3px solid #1976d2; padding-left: 10px; margin: 10px 0; background: #f0f8ff;\">\n<h2 style=\"margin-top: 10px;\">Centro Futurista de Observabilidade Azure</h2>\n<p style=\"font-size: 1.1em; color: #444;\">Utilize os filtros acima para personalizar sua visualiza√ß√£o e clique nas guias para explorar diferentes recursos do seu ambiente Azure.</p>\n</div>"
            },
            "conditionalVisibility": {
              "parameterName": "TabMain",
              "comparison": "isEqualTo",
              "value": "Overview"
            },
            "name": "navigation-help"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "// Resumo de todos os recursos\r\nresources\r\n| summarize TotalRecursos=count(), \r\n    Compute=countif(type in~ ('microsoft.compute/virtualmachines', 'microsoft.compute/hostgroups')), \r\n    Storage=countif(type has 'storage'), \r\n    Network=countif(type has 'network'), \r\n    Aplicacoes=countif(type in~ ('microsoft.web/sites', 'microsoft.web/serverfarms')),\r\n    Containers=countif(type in~ ('microsoft.containerservice/managedclusters', 'microsoft.container')),\r\n    IA=countif(type has 'cognitiveservices' or type has 'machinelearning'),\r\n    Dados=countif(type has 'sql' or type has 'cosmos' or type has 'cache')\r\n| project TotalRecursos, Compute, Network, Storage, Aplicacoes, Dados, Containers, IA",
                    "size": 1,
                    "title": "Resumo Global de Recursos",
                    "timeContext": {
                      "durationMs": 86400000
                    },
                    "timeContextFromParameter": "timerange",
                    "queryType": 1,
                    "resourceType": "microsoft.resourcegraph/resources",
                    "crossComponentResources": [
                      "{Subscription}"
                    ],
                    "visualization": "tiles",
                    "tileSettings": {
                      "titleContent": {
                        "columnMatch": "TotalRecursos",
                        "formatter": 1,
                        "formatOptions": {
                          "showIcon": true
                        }
                      },
                      "leftContent": {
                        "columnMatch": "Compute",
                        "formatter": 12,
                        "formatOptions": {
                          "palette": "blue"
                        }
                      },
                      "secondaryContent": {
                        "columnMatch": "Network",
                        "formatter": 12,
                        "formatOptions": {
                          "palette": "greenBlue"
                        }
                      },
                      "rightContent": {
                        "columnMatch": "Storage",
                        "formatter": 12,
                        "formatOptions": {
                          "palette": "purpleBright"
                        }
                      },
                      "showBorder": true
                    }
                  },
                  "name": "kpi-global-status"
                },
                {
                  "type": 10,
                  "content": {
                    "chartId": "workbook45d5f345-c6ab-4fb8-ad20-120f44b7c5a9",
                    "version": "MetricsItem/2.0",
                    "size": 0,
                    "chartType": 0,
                    "resourceType": "microsoft.resources/subscriptions",
                    "metricScope": 0,
                    "resourceIds": [
                      "{Subscription}"
                    ],
                    "timeContextFromParameter": "timerange",
                    "title": "M√©tricas Cr√≠ticas - VM, Storage e Rede",
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Subscription",
                          "formatter": 0,
                          "formatOptions": {
                            "showIcon": true
                          }
                        },
                        {
                          "columnMatch": "Name",
                          "formatter": 5,
                          "formatOptions": {
                            "showIcon": true
                          }
                        },
                        {
                          "columnMatch": "microsoft.compute/virtualmachines--Percentage CPU",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "blue",
                            "showIcon": true,
                            "aggregation": "Average"
                          },
                          "numberFormat": {
                            "unit": 1,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 1
                            }
                          }
                        },
                        {
                          "columnMatch": "microsoft.storage/storageaccounts--UsedCapacity",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "purple",
                            "showIcon": true,
                            "aggregation": "Sum"
                          },
                          "numberFormat": {
                            "unit": 2,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 1
                            }
                          }
                        },
                        {
                          "columnMatch": "microsoft.network/networkinterfaces--BytesSentRate",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "greenBlue",
                            "showIcon": true,
                            "aggregation": "Sum"
                          },
                          "numberFormat": {
                            "unit": 11,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 1
                            }
                          }
                        }
                      ]
                    }
                  },
                  "customWidth": "100",
                  "name": "critical-metrics-dashboard"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "// Status de recursos cr√≠ticos\r\nresources\r\n| where type in~ ('microsoft.compute/virtualmachines', 'microsoft.web/sites', 'microsoft.documentdb/databaseaccounts', 'microsoft.containerservice/managedclusters')\r\n| extend resourceType = case(\r\n    type =~ 'microsoft.compute/virtualmachines', 'Virtual Machines',\r\n    type =~ 'microsoft.web/sites', 'App Services',\r\n    type =~ 'microsoft.documentdb/databaseaccounts', 'Cosmos DB',\r\n    type =~ 'microsoft.containerservice/managedclusters', 'AKS',\r\n    'Outro')\r\n| extend status = case(\r\n    type =~ 'microsoft.compute/virtualmachines' and properties.extended.instanceView.powerState.displayStatus =~ 'VM running', 'Dispon√≠vel', \r\n    type =~ 'microsoft.web/sites' and properties.state =~ 'Running', 'Dispon√≠vel',\r\n    type =~ 'microsoft.documentdb/databaseaccounts' and (properties.provisioningState =~ 'Succeeded'), 'Dispon√≠vel',\r\n    type =~ 'microsoft.containerservice/managedclusters' and (properties.provisioningState =~ 'Succeeded'), 'Dispon√≠vel',\r\n    type =~ 'microsoft.compute/virtualmachines' and properties.extended.instanceView.powerState.displayStatus has 'deallocated', 'Parado',\r\n    'Indispon√≠vel')\r\n| summarize Total=count(), Dispon√≠vel=countif(status =~ 'Dispon√≠vel'), Parado=countif(status =~ 'Parado'), Indispon√≠vel=countif(status =~ 'Indispon√≠vel') by resourceType\r\n| order by resourceType asc",
                    "size": 0,
                    "title": "Status de Recursos Cr√≠ticos",
                    "timeContext": {
                      "durationMs": 86400000
                    },
                    "timeContextFromParameter": "timerange",
                    "queryType": 1,
                    "resourceType": "microsoft.resourcegraph/resources",
                    "crossComponentResources": [
                      "{Subscription}"
                    ],
                    "visualization": "table",
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Dispon√≠vel",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": ">=",
                                "thresholdValue": "0",
                                "representation": "success",
                                "text": "{0}"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "success",
                                "text": "{0}"
                              }
                            ],
                            "customColumnWidthSetting": "15ch"
                          }
                        },
                        {
                          "columnMatch": "Parado",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": ">=",
                                "thresholdValue": "1",
                                "representation": "2",
                                "text": "{0}"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Blank",
                                "text": "{0}"
                              }
                            ],
                            "customColumnWidthSetting": "15ch"
                          }
                        },
                        {
                          "columnMatch": "Indispon√≠vel",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": ">=",
                                "thresholdValue": "1",
                                "representation": "4",
                                "text": "{0}"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Blank",
                                "text": "{0}"
                              }
                            ],
                            "customColumnWidthSetting": "15ch"
                          }
                        }
                      ],
                      "sortBy": [
                        {
                          "itemKey": "resourceType",
                          "sortOrder": 1
                        }
                      ],
                      "labelSettings": [
                        {
                          "columnId": "resourceType",
                          "label": "Tipo de Recurso"
                        },
                        {
                          "columnId": "Total",
                          "label": "Total"
                        },
                        {
                          "columnId": "Dispon√≠vel",
                          "label": "Dispon√≠vel"
                        },
                        {
                          "columnId": "Parado",
                          "label": "Parado"
                        },
                        {
                          "columnId": "Indispon√≠vel",
                          "label": "Indispon√≠vel"
                        }
                      ]
                    },
                    "sortBy": [
                      {
                        "itemKey": "resourceType",
                        "sortOrder": 1
                      }
                    ]
                  },
                  "customWidth": "50",
                  "name": "query - status-recursos-criticos"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "// Distribui√ß√£o de recursos por regi√£o\r\nresources\r\n| summarize count() by location\r\n| order by count_ desc\r\n| take 10",
                    "size": 0,
                    "title": "Top 10 Regi√µes por N√∫mero de Recursos",
                    "timeContext": {
                      "durationMs": 86400000
                    },
                    "timeContextFromParameter": "timerange",
                    "queryType": 1,
                    "resourceType": "microsoft.resourcegraph/resources",
                    "crossComponentResources": [
                      "{Subscription}"
                    ],
                    "visualization": "piechart",
                    "chartSettings": {
                      "createOtherGroup": 10
                    }
                  },
                  "customWidth": "50",
                  "name": "query - recursos-por-regiao"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "// Recursos por grupo de recursos\r\nresources\r\n| summarize count() by resourceGroup\r\n| order by count_ desc\r\n| take 10",
                    "size": 0,
                    "title": "Top 10 Grupos de Recursos por N√∫mero de Recursos",
                    "timeContext": {
                      "durationMs": 86400000
                    },
                    "timeContextFromParameter": "timerange",
                    "queryType": 1,
                    "resourceType": "microsoft.resourcegraph/resources",
                    "crossComponentResources": [
                      "{Subscription}"
                    ],
                    "visualization": "barchart"
                  },
                  "customWidth": "50",
                  "name": "query - recursos-por-rg"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "// Tipos de recurso mais comuns\r\nresources\r\n| summarize count() by type\r\n| order by count_ desc\r\n| take 10",
                    "size": 0,
                    "title": "Top 10 Tipos de Recursos",
                    "timeContext": {
                      "durationMs": 86400000
                    },
                    "timeContextFromParameter": "timerange",
                    "queryType": 1,
                    "resourceType": "microsoft.resourcegraph/resources",
                    "crossComponentResources": [
                      "{Subscription}"
                    ],
                    "visualization": "barchart"
                  },
                  "customWidth": "50",
                  "name": "query - tipos-recursos"
                },
                {
                  "type": 1,
                  "content": {
                    "json": "<div style=\"background:#e3f2fd;padding:15px;border-radius:8px;margin-top:15px;\">\n<h3 style=\"margin-top:0\">üìä Central de Observabilidade Futurista</h3>\n<p>Esta dashboard central oferece uma vis√£o hol√≠stica dos seus recursos no Azure. Utilize as guias acima para explorar categorias espec√≠ficas e obter visualiza√ß√µes mais detalhadas.</p>\n<p style=\"margin-bottom:0\"><b>üí° Dica:</b> Para uma an√°lise mais detalhada sobre recursos espec√≠ficos do Azure, acesse os workbooks especializados atrav√©s da se√ß√£o \"Links R√°pidos\" abaixo.</p>\n</div>"
                  },
                  "name": "text - dashboard-info"
                },
                {
                  "type": 11,
                  "content": {
                    "version": "LinkItem/1.0",
                    "style": "list",
                    "links": [
                      {
                        "id": "9d9c1c91-d50d-4d3d-86f9-7b53f6c1ec60",
                        "cellValue": "",
                        "linkTarget": "WorkbookTemplate",
                        "linkLabel": "üíª Virtual Machine Insights",
                        "preText": "üîó Links R√°pidos:",
                        "postText": "",
                        "style": "link",
                        "linkIsContextBlade": true,
                        "workbookContext": {
                          "componentIdSource": "workbook",
                          "resourceIdsSource": "workbook",
                          "templateIdSource": "static",
                          "templateId": "Community-Workbooks/Virtual Machines/Virtual Machine Performance",
                          "typeSource": "workbook",
                          "gallerySource": "workbook",
                          "locationSource": "default"
                        }
                      },
                      {
                        "id": "d61f079e-c31a-4363-9bb9-b01273144001",
                        "cellValue": "azure_app_service_insights.workbook",
                        "linkTarget": "WorkbookTemplate",
                        "linkLabel": "üöÄ App Service Insights",
                        "preText": "",
                        "style": "link"
                      },
                      {
                        "id": "46d08368-81c9-43a7-9eef-82d3cbee22ec",
                        "cellValue": "azure_application_gateway_insights.workbook",
                        "linkTarget": "WorkbookTemplate",
                        "linkLabel": "üõ°Ô∏è Application Gateway Insights",
                        "preText": "",
                        "style": "link"
                      },
                      {
                        "id": "98f4b4d9-ea0c-4380-b8ab-b9af5632a1fb",
                        "cellValue": "azure_functions_insights.workbook",
                        "linkTarget": "WorkbookTemplate",
                        "linkLabel": "‚ö° Functions Insights",
                        "preText": "",
                        "style": "link"
                      }
                    ]
                  },
                  "name": "links - quick-access"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "TabMain",
              "comparison": "isEqualTo",
              "value": "Overview"
            },
            "name": "Overview-main"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "parameters": [
                      {
                        "id": "4c0f5dc7-b2c4-4661-9532-7a236a599a24",
                        "version": "KqlParameterItem/1.0",
                        "name": "SubTabNet",
                        "label": "Categoria de Rede",
                        "type": 1,
                        "isRequired": true,
                        "value": "NetOverview",
                        "typeSettings": {
                          "parameterMode": "navigation"
                        }
                      }
                    ],
                    "style": "pills",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces"
                  },
                  "name": "network-nav-params"
                },
                {
                  "type": 11,
                  "content": {
                    "version": "LinkItem/1.0",
                    "style": "nav",
                    "links": [
                      {
                        "id": "73329746-be6a-4d3d-8887-17d228e76c6d",
                        "cellValue": "SubTabNet",
                        "linkTarget": "parameter",
                        "linkLabel": "üó∫Ô∏è Vis√£o Geral",
                        "subTarget": "NetOverview",
                        "style": "link",
                        "icon": "Dashboard"
                      },
                      {
                        "id": "6522aa0c-4c34-4e3d-8e39-c66e50e5c639",
                        "cellValue": "SubTabNet",
                        "linkTarget": "parameter",
                        "linkLabel": "üåê Virtual Network",
                        "subTarget": "VNet",
                        "style": "link",
                        "icon": "Network"
                      },
                      {
                        "id": "9aaab219-3d6e-4321-95c0-de884cfb29d4",
                        "cellValue": "SubTabNet",
                        "linkTarget": "parameter",
                        "linkLabel": "üõ°Ô∏è NSG",
                        "subTarget": "NSG",
                        "style": "link",
                        "icon": "Shield"
                      },
                      {
                        "id": "802e807b-cbf7-4d0b-84c2-af2e0869c1d5",
                        "cellValue": "SubTabNet",
                        "linkTarget": "parameter",
                        "linkLabel": "üîÄ Load Balancer",
                        "subTarget": "LB",
                        "style": "link",
                        "icon": "Switch"
                      },
                      {
                        "id": "e9a5e5a1-c5c7-499f-8f33-95f600d15f5c",
                        "cellValue": "SubTabNet",
                        "linkTarget": "parameter",
                        "linkLabel": "üåÄ Application Gateway",
                        "subTarget": "AppGW",
                        "style": "link",
                        "icon": "Gateway"
                      },
                      {
                        "id": "866a96d2-6a47-4a33-a437-61942169dc8f",
                        "cellValue": "SubTabNet",
                        "linkTarget": "parameter",
                        "linkLabel": "üîí VPN Gateway",
                        "subTarget": "VPNGW",
                        "style": "link",
                        "icon": "VpnGateway"
                      },
                      {
                        "id": "54539eb3-8102-42ed-a93c-27574aa9a316",
                        "cellValue": "SubTabNet",
                        "linkTarget": "parameter",
                        "linkLabel": "üî• Firewall",
                        "subTarget": "FW",
                        "style": "link",
                        "icon": "Firewall"
                      },
                      {
                        "id": "86b7fb57-07c8-499f-8cb9-b2a33bb93a8a",
                        "cellValue": "SubTabNet",
                        "linkTarget": "parameter",
                        "linkLabel": "üö¶ Traffic Manager",
                        "subTarget": "TrafficManager",
                        "style": "link",
                        "icon": "TrafficManager"
                      }
                    ]
                  },
                  "name": "links - network-submenu"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "<h2 style=\"color:#003366\">Vis√£o Geral de Rede</h2>\n<p style=\"color:#003366\">An√°lise global de recursos de rede no Azure, incluindo status, disponibilidade e m√©tricas de tr√°fego.</p>"
                        },
                        "name": "text - net-overview-header"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "// Resumo de recursos de rede\r\nresources\r\n| where type has 'network'\r\n| extend resourceType = case(\r\n    type =~ 'microsoft.network/virtualnetworks', 'Virtual Networks',\r\n    type =~ 'microsoft.network/networksecuritygroups', 'NSG',\r\n    type =~ 'microsoft.network/loadbalancers', 'Load Balancer',\r\n    type =~ 'microsoft.network/applicationgateways', 'App Gateway',\r\n    type =~ 'microsoft.network/vpngateways', 'VPN Gateway',\r\n    type =~ 'microsoft.network/azurefirewalls', 'Azure Firewall',\r\n    type =~ 'microsoft.network/trafficmanagerprofiles', 'Traffic Manager',\r\n    type =~ 'microsoft.network/frontdoors', 'Front Door',\r\n    type =~ 'microsoft.network/privatelinkservices', 'Private Link',\r\n    type =~ 'microsoft.network/bastionhosts', 'Bastion',\r\n    'Outros')\r\n| summarize Total=count() by resourceType\r\n| order by Total desc",
                          "size": 1,
                          "title": "Distribui√ß√£o de Recursos de Rede",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "visualization": "piechart"
                        },
                        "customWidth": "50",
                        "name": "query - recuros-rede"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "// Prefixos de VNet mais comuns\r\nresources\r\n| where type =~ 'microsoft.network/virtualnetworks'\r\n| extend prefixo = tostring(properties.addressSpace.addressPrefixes[0])\r\n| extend cidrSize = tostring(split(prefixo, '/')[-1])\r\n| extend cidrClass = case(\r\n    cidrSize == '16', 'Classe B (/16)',\r\n    cidrSize == '24', 'Classe C (/24)',\r\n    cidrSize == '8', 'Classe A (/8)',\r\n    strcat('CIDR /', cidrSize))\r\n| summarize Total=count() by cidrClass\r\n| order by Total desc",
                          "size": 1,
                          "title": "Distribui√ß√£o de CIDRs das VNets",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "visualization": "piechart"
                        },
                        "customWidth": "50",
                        "name": "query - cidrs-vnets"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "// Conex√µes de peering de VNet\r\nresources\r\n| where type =~ 'microsoft.network/virtualnetworks'\r\n| mv-expand peering=properties.virtualNetworkPeerings\r\n| extend peeringName = tostring(peering.name), remoteVnet = tostring(split(peering.properties.remoteVirtualNetwork.id, '/')[-1]), peeringState = tostring(peering.properties.peeringState)\r\n| project vNet=name, peeringName, remoteVnet, peeringState\r\n| order by vNet, remoteVnet",
                          "size": 0,
                          "title": "Virtual Network Peerings",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "peeringState",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Connected",
                                      "representation": "success",
                                      "text": "{0}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Disconnected",
                                      "representation": "failed",
                                      "text": "{0}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Initializing",
                                      "representation": "pending",
                                      "text": "{0}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "unknown",
                                      "text": "{0}"
                                    }
                                  ]
                                }
                              }
                            ]
                          }
                        },
                        "name": "query - vnet-peerings"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "<div style=\"background:#f0f7ff;padding:15px;border-radius:8px;margin-top:15px;\">\n<h3 style=\"margin-top:0\">üîó Conectividade de Rede</h3>\n<p>A dashboard acima oferece uma vis√£o hol√≠stica da sua infraestrutura de rede no Azure. Para uma an√°lise mais detalhada, selecione a categoria espec√≠fica nos submenus acima.</p>\n<p style=\"margin-bottom:0\"><b>üí° Dica:</b> Clique em qualquer se√ß√£o do gr√°fico para filtrar os resultados ou use o menu Networking para ver an√°lises detalhadas de cada componente de rede.</p>\n</div>"
                        },
                        "name": "text - net-overview-info"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "SubTabNet",
                    "comparison": "isEqualTo",
                    "value": "NetOverview"
                  },
                  "name": "group-network-overview"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "<h2 style=\"color:#003366\">Virtual Networks (VNets)</h2>\n<p style=\"color:#003366\">An√°lise detalhada de redes virtuais, incluindo subnets, peerings e configura√ß√£o.</p>"
                        },
                        "name": "text - vnet-header"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "// Lista de redes virtuais\r\nresources\r\n| where type =~ 'microsoft.network/virtualnetworks'\r\n| extend addressSpace = tostring(properties.addressSpace.addressPrefixes[0])\r\n| extend subnets = array_length(properties.subnets)\r\n| extend peerings = array_length(properties.virtualNetworkPeerings)\r\n| extend dnsServers = iff(isnotempty(properties.dhcpOptions.dnsServers), tostring(properties.dhcpOptions.dnsServers), 'Padr√£o Azure')\r\n| project name, resourceGroup, location, addressSpace, ['Subnets']=subnets, ['Peerings']=peerings, dnsServers\r\n| order by name asc",
                          "size": 0,
                          "title": "Virtual Networks",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "visualization": "table",
                          "showExportToExcel": true,
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "name",
                                "formatter": 13,
                                "formatOptions": {
                                  "linkTarget": "Resource",
                                  "showIcon": true
                                }
                              },
                              {
                                "columnMatch": "Subnets",
                                "formatter": 3,
                                "formatOptions": {
                                  "palette": "blue",
                                  "customColumnWidthSetting": "15ch"
                                }
                              },
                              {
                                "columnMatch": "Peerings",
                                "formatter": 3,
                                "formatOptions": {
                                  "palette": "green",
                                  "customColumnWidthSetting": "15ch"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "name": "query - vnet-list"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "// Detalhes de subnets\r\nresources\r\n| where type =~ 'microsoft.network/virtualnetworks'\r\n| mv-expand subnet=properties.subnets\r\n| extend subnetName = tostring(subnet.name)\r\n| extend prefix = tostring(subnet.properties.addressPrefix)\r\n| extend nsgId = iff(isnotempty(subnet.properties.networkSecurityGroup.id), tostring(subnet.properties.networkSecurityGroup.id), 'Sem NSG')\r\n| extend nsgName = iff(isnotempty(nsgId) and nsgId != 'Sem NSG', split(nsgId, '/')[-1], 'Sem NSG')\r\n| extend delegations = array_length(iff(isnotempty(subnet.properties.delegations), subnet.properties.delegations, dynamic([])))\r\n| project vnetName = name, resourceGroup, subnetName, prefix, cidrSize = split(prefix, '/')[-1], nsgName, subnet_type = iff(subnetName startswith 'AzureBastionSubnet', 'üîë Bastion', iff(subnetName startswith 'GatewaySubnet', 'üåê Gateway', iff(subnetName startswith 'AzureFirewall', 'üõ°Ô∏è Firewall', 'üñß Padr√£o'))), delegations\r\n| order by tostring(vnetName) asc, tostring(subnetName) asc",
                          "size": 0,
                          "title": "Subnets",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "visualization": "table",
                          "showExportToExcel": true,
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "nsgName",
                                "formatter": 13,
                                "formatOptions": {
                                  "linkTarget": "Resource",
                                  "showIcon": true
                                }
                              },
                              {
                                "columnMatch": "subnet_type",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "contains",
                                      "thresholdValue": "Bastion",
                                      "representation": "Firewall",
                                      "text": "{0}"
                                    },
                                    {
                                      "operator": "contains",
                                      "thresholdValue": "Gateway",
                                      "representation": "Globe",
                                      "text": "{0}"
                                    },
                                    {
                                      "operator": "contains",
                                      "thresholdValue": "Firewall",
                                      "representation": "Shield",
                                      "text": "{0}"
                                    },
                                    {
                                      "operator": "contains",
                                      "thresholdValue": "Padr√£o",
                                      "representation": "NetworkInterfaceCard",
                                      "text": "{0}"
                                    }
                                  ]
                                }
                              }
                            ],
                            "filter": true,
                            "hierarchySettings": {
                              "treeType": 1,
                              "groupBy": [
                                "vnetName"
                              ]
                            }
                          }
                        },
                        "name": "query - vnet-subnets"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "// Uso de endere√ßos IP por VNet\r\nresources\r\n| where type =~ 'microsoft.network/virtualnetworks'\r\n| extend addressSpace = tostring(properties.addressSpace.addressPrefixes[0])\r\n| extend ipRange = split(addressSpace, '/')\r\n| extend cidrSize = toint(ipRange[1])\r\n| extend totalIPs = pow(2, 32 - cidrSize)\r\n| join kind=leftouter (\r\n    resources\r\n    | where type =~ 'microsoft.network/networkinterfaces'\r\n    | mv-expand ipConfig = properties.ipConfigurations\r\n    | extend privateIP = tostring(ipConfig.properties.privateIPAddress)\r\n    | extend subnetId = tostring(ipConfig.properties.subnet.id)\r\n    | extend vnetName = tostring(split(subnetId, '/')[8])\r\n    | where isnotempty(vnetName)\r\n    | summarize IPsInUse=count() by vnetName\r\n) on $left.name == $right.vnetName\r\n| project VNet=name, ResourceGroup=resourceGroup, AddressSpace=addressSpace, TotalIPs=totalIPs, IPsInUse=iff(isnotempty(IPsInUse), IPsInUse, 0), PercentUtilization=(toreal(iff(isnotempty(IPsInUse), IPsInUse, 0)) / toreal(totalIPs)) * 100\r\n| order by PercentUtilization desc",
                          "size": 0,
                          "title": "Utiliza√ß√£o de Endere√ßos IP por VNet",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "visualization": "table",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "AddressSpace",
                                "formatter": 0,
                                "formatOptions": {
                                  "customColumnWidthSetting": "20ch"
                                }
                              },
                              {
                                "columnMatch": "TotalIPs",
                                "formatter": 0,
                                "numberFormat": {
                                  "unit": 0,
                                  "options": {
                                    "style": "decimal",
                                    "useGrouping": true
                                  }
                                }
                              },
                              {
                                "columnMatch": "IPsInUse",
                                "formatter": 0,
                                "numberFormat": {
                                  "unit": 0,
                                  "options": {
                                    "style": "decimal",
                                    "useGrouping": true
                                  }
                                }
                              },
                              {
                                "columnMatch": "PercentUtilization",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "redBright",
                                  "customColumnWidthSetting": "18ch"
                                },
                                "numberFormat": {
                                  "unit": 1,
                                  "options": {
                                    "style": "decimal",
                                    "useGrouping": false,
                                    "maximumFractionDigits": 2
                                  }
                                }
                              }
                            ]
                          }
                        },
                        "name": "query - vnet-ip-usage"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "SubTabNet",
                    "comparison": "isEqualTo",
                    "value": "VNet"
                  },
                  "name": "group-network-vnet"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "<h2 style=\"color:#003366\">Network Security Groups (NSGs)</h2>\n<p style=\"color:#003366\">An√°lise detalhada de Network Security Groups, regras de seguran√ßa e configura√ß√µes de seguran√ßa de rede.</p>"
                        },
                        "name": "text - nsg-header"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "// Lista de NSGs\r\nresources\r\n| where type =~ 'microsoft.network/networksecuritygroups'\r\n| extend ruleCount = array_length(properties.securityRules)\r\n| extend defaultRuleCount = array_length(properties.defaultSecurityRules)\r\n| extend associatedSubnets = array_length(properties.subnets)\r\n| extend associatedNics = array_length(properties.networkInterfaces)\r\n| project name, resourceGroup, location, ['Regras Personalizadas']=ruleCount, ['Regras Padr√£o']=defaultRuleCount, ['Subnets Associadas']=associatedSubnets, ['NICs Associadas']=associatedNics\r\n| order by name asc",
                          "size": 0,
                          "title": "Network Security Groups",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "visualization": "table",
                          "showExportToExcel": true,
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "name",
                                "formatter": 13,
                                "formatOptions": {
                                  "linkTarget": "Resource",
                                  "showIcon": true
                                }
                              },
                              {
                                "columnMatch": "Regras Personalizadas",
                                "formatter": 3,
                                "formatOptions": {
                                  "palette": "blue",
                                  "customColumnWidthSetting": "18ch"
                                }
                              },
                              {
                                "columnMatch": "Regras Padr√£o",
                                "formatter": 3,
                                "formatOptions": {
                                  "palette": "gray",
                                  "customColumnWidthSetting": "18ch"
                                }
                              },
                              {
                                "columnMatch": "Subnets Associadas",
                                "formatter": 3,
                                "formatOptions": {
                                  "palette": "greenBlue",
                                  "customColumnWidthSetting": "18ch"
                                }
                              },
                              {
                                "columnMatch": "NICs Associadas",
                                "formatter": 3,
                                "formatOptions": {
                                  "palette": "green",
                                  "customColumnWidthSetting": "18ch"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "name": "query - nsg-list"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "fb9afc7f-3bb7-45d0-9559-a7d6a59f78d8",
                              "version": "KqlParameterItem/1.0",
                              "name": "NSG",
                              "label": "Network Security Group",
                              "type": 5,
                              "isRequired": true,
                              "multiSelect": false,
                              "query": "resources\r\n| where type =~ 'microsoft.network/networksecuritygroups'\r\n| project value = id, label = name\r\n| order by label asc",
                              "crossComponentResources": [
                                "{Subscription}"
                              ],
                              "typeSettings": {
                                "additionalResourceOptions": []
                              },
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources"
                            }
                          ],
                          "style": "above",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources"
                        },
                        "name": "parameters - nsg"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "// Detalhes de regras personalizadas de NSG\r\nresources\r\n| where type =~ 'microsoft.network/networksecuritygroups'\r\n| where id == '{NSG}'\r\n| mv-expand rule=properties.securityRules\r\n| extend ruleName = tostring(rule.name)\r\n| extend description = tostring(rule.properties.description)\r\n| extend priority = toint(rule.properties.priority)\r\n| extend direction = tostring(rule.properties.direction)\r\n| extend access = tostring(rule.properties.access)\r\n| extend protocol = tostring(rule.properties.protocol)\r\n| extend sourceAddressPrefix = tostring(rule.properties.sourceAddressPrefix)\r\n| extend sourcePortRange = tostring(rule.properties.sourcePortRange)\r\n| extend destinationAddressPrefix = tostring(rule.properties.destinationAddressPrefix)\r\n| extend destinationPortRange = tostring(rule.properties.destinationPortRange)\r\n| project ruleName, description, priority, direction, access, protocol, sourceAddressPrefix, sourcePortRange, destinationAddressPrefix, destinationPortRange\r\n| order by priority asc, ruleName asc",
                          "size": 0,
                          "title": "Regras Personalizadas de NSG",
                          "noDataMessage": "Selecione um NSG para ver suas regras personalizadas",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "visualization": "table",
                          "showExportToExcel": true,
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "ruleName",
                                "formatter": 16,
                                "formatOptions": {
                                  "showIcon": true
                                }
                              },
                              {
                                "columnMatch": "direction",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Inbound",
                                      "representation": "Received",
                                      "text": "{0}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Outbound",
                                      "representation": "Sent",
                                      "text": "{0}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "more",
                                      "text": "{0}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "access",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Allow",
                                      "representation": "success",
                                      "text": "{0}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Deny",
                                      "representation": "disabled",
                                      "text": "{0}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "more",
                                      "text": "{0}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "protocol",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "*",
                                      "representation": "1",
                                      "text": "Qualquer"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Tcp",
                                      "representation": "Normal",
                                      "text": "{0}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Udp",
                                      "representation": "Blank",
                                      "text": "{0}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "more",
                                      "text": "{0}"
                                    }
                                  ]
                                }
                              }
                            ],
                            "filter": true,
                            "labelSettings": [
                              {
                                "columnId": "ruleName",
                                "label": "Nome da Regra"
                              },
                              {
                                "columnId": "description",
                                "label": "Descri√ß√£o"
                              },
                              {
                                "columnId": "priority",
                                "label": "Prioridade"
                              },
                              {
                                "columnId": "direction",
                                "label": "Dire√ß√£o"
                              },
                              {
                                "columnId": "access",
                                "label": "Acesso"
                              },
                              {
                                "columnId": "protocol",
                                "label": "Protocolo"
                              },
                              {
                                "columnId": "sourceAddressPrefix",
                                "label": "Origem"
                              },
                              {
                                "columnId": "sourcePortRange",
                                "label": "Porta Origem"
                              },
                              {
                                "columnId": "destinationAddressPrefix",
                                "label": "Destino"
                              },
                              {
                                "columnId": "destinationPortRange",
                                "label": "Porta Destino"
                              }
                            ]
                          }
                        },
                        "name": "query - nsg-custom-rules"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "// An√°lise de riscos de seguran√ßa em NSGs\r\nresources\r\n| where type =~ 'microsoft.network/networksecuritygroups'\r\n| mv-expand rule=properties.securityRules\r\n| where rule.properties.access =~ 'Allow'\r\n| extend ruleName = tostring(rule.name)\r\n| extend direction = tostring(rule.properties.direction)\r\n| extend protocol = tostring(rule.properties.protocol)\r\n| extend sourceAddressPrefix = tostring(rule.properties.sourceAddressPrefix)\r\n| extend destinationPortRange = tostring(rule.properties.destinationPortRange)\r\n| extend nsgName = name\r\n| extend riskLevel = case(\r\n    sourceAddressPrefix =~ 'Internet' and (destinationPortRange == '22' or destinationPortRange == '3389'), 'Alto',\r\n    sourceAddressPrefix =~ '*' or sourceAddressPrefix =~ 'Internet', 'M√©dio',\r\n    'Baixo')\r\n| where riskLevel in ('Alto', 'M√©dio')\r\n| project nsgName, resourceGroup, ruleName, direction, protocol, sourceAddressPrefix, destinationPortRange, riskLevel\r\n| order by riskLevel asc, nsgName, ruleName",
                          "size": 0,
                          "title": "Regras de NSG com Potencial Risco de Seguran√ßa",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "visualization": "table",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "nsgName",
                                "formatter": 13,
                                "formatOptions": {
                                  "linkTarget": "Resource",
                                  "showIcon": true
                                }
                              },
                              {
                                "columnMatch": "riskLevel",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Alto",
                                      "representation": "redBright",
                                      "text": "{0}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "M√©dio",
                                      "representation": "yellow",
                                      "text": "{0}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "green",
                                      "text": "{0}"
                                    }
                                  ]
                                }
                              }
                            ],
                            "filter": true,
                            "labelSettings": [
                              {
                                "columnId": "nsgName",
                                "label": "Nome do NSG"
                              },
                              {
                                "columnId": "resourceGroup",
                                "label": "Grupo de Recursos"
                              },
                              {
                                "columnId": "ruleName",
                                "label": "Nome da Regra"
                              },
                              {
                                "columnId": "direction",
                                "label": "Dire√ß√£o"
                              },
                              {
                                "columnId": "protocol",
                                "label": "Protocolo"
                              },
                              {
                                "columnId": "sourceAddressPrefix",
                                "label": "Origem"
                              },
                              {
                                "columnId": "destinationPortRange",
                                "label": "Porta Destino"
                              },
                              {
                                "columnId": "riskLevel",
                                "label": "N√≠vel de Risco"
                              }
                            ]
                          }
                        },
                        "name": "query - nsg-risk-analysis"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "<div style=\"background:#f0f7ff;padding:15px;border-radius:8px;margin-top:15px;\">\n<h3 style=\"margin-top:0\">üîí An√°lise de Seguran√ßa NSG</h3>\n<p>A an√°lise acima identifica regras de NSG que podem apresentar riscos de seguran√ßa. As regras s√£o classificadas por n√≠vel de risco:</p>\n<ul>\n<li><span style=\"color:#d32f2f;font-weight:bold;\">Alto</span>: Acesso SSH (porta 22) ou RDP (porta 3389) permitido da Internet</li>\n<li><span style=\"color:#fbc02d;font-weight:bold;\">M√©dio</span>: Acesso permitido de qualquer origem (*) ou da Internet</li>\n<li><span style=\"color:#388e3c;font-weight:bold;\">Baixo</span>: Regras com acesso mais restrito</li>\n</ul>\n<p style=\"margin-bottom:0\">Considere revisar e ajustar as regras de alto e m√©dio risco conforme necess√°rio para sua estrat√©gia de seguran√ßa.</p>\n</div>"
                        },
                        "name": "text - nsg-risk-info"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "SubTabNet",
                    "comparison": "isEqualTo",
                    "value": "NSG"
                  },
                  "name": "group-network-nsg"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "<h2 style=\"color:#003366\">Load Balancers</h2>\n<p style=\"color:#003366\">An√°lise detalhada de balanceadores de carga, incluindo frontend IPs, regras de balanceamento e health probes.</p>"
                        },
                        "name": "text - lb-header"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "7c7b3a6e-318c-4ac6-a7ab-48b073e15c11",
                              "version": "KqlParameterItem/1.0",
                              "name": "LoadBalancerResource",
                              "label": "Load Balancer",
                              "type": 5,
                              "isRequired": false,
                              "multiSelect": false,
                              "query": "resources\r\n| where type == 'microsoft.network/loadbalancers'\r\n| project id, name\r\n| order by name asc",
                              "crossComponentResources": [
                                "{Subscription}"
                              ],
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources"
                            }
                          ],
                          "style": "above",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources"
                        },
                        "name": "parameters - lb"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "// Lista de Load Balancers\r\nresources\r\n| where type == 'microsoft.network/loadbalancers'\r\n| extend skuName = tostring(sku.name)\r\n| extend inboundNatRules = array_length(properties.inboundNatRules)\r\n| extend loadBalancingRules = array_length(properties.loadBalancingRules)\r\n| extend probes = array_length(properties.probes)\r\n| extend frontendCount = array_length(properties.frontendIPConfigurations)\r\n| extend backendCount = array_length(properties.backendAddressPools)\r\n| project name, resourceGroup, location, skuName, inboundNatRules, loadBalancingRules, probes, frontendCount, backendCount\r\n| order by name asc",
                          "size": 0,
                          "title": "Load Balancers",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "visualization": "table",
                          "showExportToExcel": true,
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "name",
                                "formatter": 13,
                                "formatOptions": {
                                  "linkTarget": "Resource",
                                  "showIcon": true
                                }
                              },
                              {
                                "columnMatch": "skuName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Standard",
                                      "representation": "success",
                                      "text": "{0}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Basic",
                                      "representation": "2",
                                      "text": "{0}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Blank",
                                      "text": "{0}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "inboundNatRules",
                                "formatter": 3,
                                "formatOptions": {
                                  "palette": "blue",
                                  "customColumnWidthSetting": "18ch"
                                }
                              },
                              {
                                "columnMatch": "loadBalancingRules",
                                "formatter": 3,
                                "formatOptions": {
                                  "palette": "greenBlue",
                                  "customColumnWidthSetting": "18ch"
                                }
                              },
                              {
                                "columnMatch": "probes",
                                "formatter": 3,
                                "formatOptions": {
                                  "palette": "turquoise",
                                  "customColumnWidthSetting": "18ch"
                                }
                              },
                              {
                                "columnMatch": "frontendCount",
                                "formatter": 3,
                                "formatOptions": {
                                  "palette": "purple",
                                  "customColumnWidthSetting": "18ch"
                                }
                              },
                              {
                                "columnMatch": "backendCount",
                                "formatter": 3,
                                "formatOptions": {
                                  "palette": "green",
                                  "customColumnWidthSetting": "18ch"
                                }
                              }
                            ],
                            "filter": true,
                            "labelSettings": [
                              {
                                "columnId": "name",
                                "label": "Nome"
                              },
                              {
                                "columnId": "resourceGroup",
                                "label": "Grupo de Recursos"
                              },
                              {
                                "columnId": "location",
                                "label": "Regi√£o"
                              },
                              {
                                "columnId": "skuName",
                                "label": "SKU"
                              },
                              {
                                "columnId": "inboundNatRules",
                                "label": "Regras NAT"
                              },
                              {
                                "columnId": "loadBalancingRules",
                                "label": "Regras LB"
                              },
                              {
                                "columnId": "probes",
                                "label": "Health Probes"
                              },
                              {
                                "columnId": "frontendCount",
                                "label": "Frontend IPs"
                              },
                              {
                                "columnId": "backendCount",
                                "label": "Backend Pools"
                              }
                            ]
                          }
                        },
                        "name": "query - lb-list"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "// Detalhes de Frontend IPs\r\nresources\r\n| where type == 'microsoft.network/loadbalancers'\r\n| where id == '{LoadBalancerResource}' or isempty('{LoadBalancerResource}')\r\n| mvexpand frontend=properties.frontendIPConfigurations\r\n| extend frontendName = tostring(frontend.name)\r\n| extend privateIPAddress = tostring(frontend.properties.privateIPAddress)\r\n| extend privateIPAllocationMethod = tostring(frontend.properties.privateIPAllocationMethod)\r\n| extend publicIPId = tostring(frontend.properties.publicIPAddress.id)\r\n| extend publicIPName = iff(isnotempty(publicIPId), tostring(split(publicIPId, '/')[-1]), '')\r\n| extend subnetId = tostring(frontend.properties.subnet.id)\r\n| extend subnetName = iff(isnotempty(subnetId), tostring(split(subnetId, '/')[-1]), '')\r\n| extend lbName = name\r\n| project lbName, frontendName, privateIPAddress, privateIPAllocationMethod, publicIPName, subnetName\r\n| order by lbName asc, frontendName asc",
                          "size": 0,
                          "title": "Frontend IP Configurations",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "lbName",
                                "formatter": 13,
                                "formatOptions": {
                                  "linkTarget": "Resource",
                                  "showIcon": true
                                }
                              },
                              {
                                "columnMatch": "privateIPAllocationMethod",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Static",
                                      "representation": "Locked",
                                      "text": "{0}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Dynamic",
                                      "representation": "Play",
                                      "text": "{0}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Blank",
                                      "text": "{0}"
                                    }
                                  ]
                                }
                              }
                            ],
                            "filter": true,
                            "labelSettings": [
                              {
                                "columnId": "lbName",
                                "label": "Load Balancer"
                              },
                              {
                                "columnId": "frontendName",
                                "label": "Nome Frontend"
                              },
                              {
                                "columnId": "privateIPAddress",
                                "label": "IP Privado"
                              },
                              {
                                "columnId": "privateIPAllocationMethod",
                                "label": "M√©todo de Aloca√ß√£o"
                              },
                              {
                                "columnId": "publicIPName",
                                "label": "IP P√∫blico"
                              },
                              {
                                "columnId": "subnetName",
                                "label": "Subnet"
                              }
                            ]
                          }
                        },
                        "customWidth": "50",
                        "name": "query - lb-frontends"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "// Detalhes de Backend Pools\r\nresources\r\n| where type == 'microsoft.network/loadbalancers'\r\n| where id == '{LoadBalancerResource}' or isempty('{LoadBalancerResource}')\r\n| mvexpand backend=properties.backendAddressPools\r\n| extend backendName = tostring(backend.name)\r\n| extend backendIPConfigs = array_length(iff(isnotempty(backend.properties.backendIPConfigurations), backend.properties.backendIPConfigurations, dynamic([])))\r\n| extend lbName = name\r\n| project lbName, backendName, backendIPConfigs\r\n| order by lbName asc, backendName asc",
                          "size": 0,
                          "title": "Backend Address Pools",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "lbName",
                                "formatter": 13,
                                "formatOptions": {
                                  "linkTarget": "Resource",
                                  "showIcon": true
                                }
                              },
                              {
                                "columnMatch": "backendIPConfigs",
                                "formatter": 3,
                                "formatOptions": {
                                  "palette": "blue",
                                  "customColumnWidthSetting": "18ch"
                                }
                              }
                            ],
                            "filter": true,
                            "labelSettings": [
                              {
                                "columnId": "lbName",
                                "label": "Load Balancer"
                              },
                              {
                                "columnId": "backendName",
                                "label": "Backend Pool"
                              },
                              {
                                "columnId": "backendIPConfigs",
                                "label": "Qtd. IPs"
                              }
                            ]
                          }
                        },
                        "customWidth": "50",
                        "name": "query - lb-backends"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "// Detalhes de regras de balanceamento\r\nresources\r\n| where type == 'microsoft.network/loadbalancers'\r\n| where id == '{LoadBalancerResource}'\r\n| mvexpand rule=properties.loadBalancingRules\r\n| extend ruleName = tostring(rule.name)\r\n| extend frontendIPConfigId = tostring(rule.properties.frontendIPConfiguration.id)\r\n| extend frontendIPName = tostring(split(frontendIPConfigId, '/')[-1])\r\n| extend protocol = tostring(rule.properties.protocol)\r\n| extend frontendPort = toint(rule.properties.frontendPort)\r\n| extend backendPort = toint(rule.properties.backendPort)\r\n| extend idleTimeoutInMinutes = toint(rule.properties.idleTimeoutInMinutes)\r\n| extend loadDistribution = tostring(rule.properties.loadDistribution)\r\n| extend enableFloatingIP = tobool(rule.properties.enableFloatingIP)\r\n| extend disableOutboundSnat = tobool(rule.properties.disableOutboundSnat)\r\n| extend probeId = tostring(rule.properties.probe.id)\r\n| extend probeName = tostring(split(probeId, '/')[-1])\r\n| project ruleName, frontendIPName, protocol, frontendPort, backendPort, loadDistribution, enableFloatingIP, disableOutboundSnat, idleTimeoutInMinutes, probeName\r\n| order by ruleName asc",
                          "size": 0,
                          "title": "Regras de Balanceamento",
                          "noDataMessage": "Selecione um Load Balancer para ver suas regras",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "protocol",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Tcp",
                                      "representation": "Normal",
                                      "text": "{0}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Udp",
                                      "representation": "Blank",
                                      "text": "{0}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "more",
                                      "text": "{0}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "enableFloatingIP",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "true",
                                      "representation": "Check",
                                      "text": "Sim"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "false",
                                      "representation": "cancelled",
                                      "text": "N√£o"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Blank",
                                      "text": "{0}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "disableOutboundSnat",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "true",
                                      "representation": "Check",
                                      "text": "Sim"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "false",
                                      "representation": "cancelled",
                                      "text": "N√£o"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Blank",
                                      "text": "{0}"
                                    }
                                  ]
                                }
                              }
                            ],
                            "filter": true,
                            "labelSettings": [
                              {
                                "columnId": "ruleName",
                                "label": "Nome da Regra"
                              },
                              {
                                "columnId": "frontendIPName",
                                "label": "Frontend IP"
                              },
                              {
                                "columnId": "protocol",
                                "label": "Protocolo"
                              },
                              {
                                "columnId": "frontendPort",
                                "label": "Porta Frontend"
                              },
                              {
                                "columnId": "backendPort",
                                "label": "Porta Backend"
                              },
                              {
                                "columnId": "loadDistribution",
                                "label": "Distribui√ß√£o"
                              },
                              {
                                "columnId": "enableFloatingIP",
                                "label": "IP Flutuante"
                              },
                              {
                                "columnId": "disableOutboundSnat",
                                "label": "SNAT Desabilitado"
                              },
                              {
                                "columnId": "idleTimeoutInMinutes",
                                "label": "Timeout (min)"
                              },
                              {
                                "columnId": "probeName",
                                "label": "Health Probe"
                              }
                            ]
                          }
                        },
                        "name": "query - lb-rules"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "// Health Probes\r\nresources\r\n| where type == 'microsoft.network/loadbalancers'\r\n| where id == '{LoadBalancerResource}'\r\n| mvexpand probe=properties.probes\r\n| extend probeName = tostring(probe.name)\r\n| extend protocol = tostring(probe.properties.protocol)\r\n| extend port = toint(probe.properties.port)\r\n| extend intervalInSeconds = toint(probe.properties.intervalInSeconds)\r\n| extend numberOfProbes = toint(probe.properties.numberOfProbes)\r\n| extend requestPath = tostring(probe.properties.requestPath)\r\n| project probeName, protocol, port, intervalInSeconds, numberOfProbes, requestPath\r\n| order by probeName asc",
                          "size": 0,
                          "title": "Health Probes",
                          "noDataMessage": "Selecione um Load Balancer para ver suas health probes",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "protocol",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Http",
                                      "representation": "Http",
                                      "text": "{0}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Https",
                                      "representation": "Https",
                                      "text": "{0}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Tcp",
                                      "representation": "Normal",
                                      "text": "{0}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Blank",
                                      "text": "{0}"
                                    }
                                  ]
                                }
                              }
                            ],
                            "filter": true,
                            "labelSettings": [
                              {
                                "columnId": "probeName",
                                "label": "Nome"
                              },
                              {
                                "columnId": "protocol",
                                "label": "Protocolo"
                              },
                              {
                                "columnId": "port",
                                "label": "Porta"
                              },
                              {
                                "columnId": "intervalInSeconds",
                                "label": "Intervalo (seg)"
                              },
                              {
                                "columnId": "numberOfProbes",
                                "label": "# Probes"
                              },
                              {
                                "columnId": "requestPath",
                                "label": "Caminho"
                              }
                            ]
                          }
                        },
                        "name": "query - lb-probes"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "SubTabNet",
                    "comparison": "isEqualTo",
                    "value": "LB"
                  },
                  "name": "group-network-lb"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "<h2 style=\"color:#003366\">Application Gateway</h2>\n<p style=\"color:#003366\">An√°lise detalhada de Application Gateways, listeners, regras, back-ends e m√©tricas de performance.</p>"
                        },
                        "name": "text - appgw-header"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "d5d7c893-f31b-4065-9f30-09f4c8259111",
                              "version": "KqlParameterItem/1.0",
                              "name": "AppGateway",
                              "label": "Application Gateway",
                              "type": 5,
                              "isRequired": false,
                              "multiSelect": false,
                              "query": "resources\r\n| where type =~ 'microsoft.network/applicationgateways'\r\n| project id, name\r\n| order by name asc",
                              "crossComponentResources": [
                                "{Subscription}"
                              ],
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources"
                            }
                          ],
                          "style": "above",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources"
                        },
                        "name": "parameters - appgw"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "// Lista de Application Gateways\r\nresources\r\n| where type =~ 'microsoft.network/applicationgateways'\r\n| extend skuName = tostring(sku.name)\r\n| extend skuTier = tostring(sku.tier)\r\n| extend capacity = toint(sku.capacity)\r\n| extend httpListenersCount = array_length(properties.httpListeners)\r\n| extend backendPoolsCount = array_length(properties.backendAddressPools)\r\n| extend requestRoutingRulesCount = array_length(properties.requestRoutingRules)\r\n| extend operationalState = tostring(properties.operationalState)\r\n| extend wafMode = tostring(iff(isnotempty(properties.webApplicationFirewallConfiguration), properties.webApplicationFirewallConfiguration.firewallMode, 'N√£o configurado'))\r\n| project name, resourceGroup, location, skuName, skuTier, capacity, operationalState, httpListenersCount, backendPoolsCount, requestRoutingRulesCount, wafMode\r\n| order by name asc",
                          "size": 0,
                          "title": "Application Gateways",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "visualization": "table",
                          "showExportToExcel": true,
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "name",
                                "formatter": 13,
                                "formatOptions": {
                                  "linkTarget": "Resource",
                                  "showIcon": true
                                }
                              },
                              {
                                "columnMatch": "skuTier",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "WAF_v2",
                                      "representation": "Shield",
                                      "text": "{0}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Standard_v2",
                                      "representation": "Normal",
                                      "text": "{0}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Blank",
                                      "text": "{0}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "operationalState",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Running",
                                      "representation": "success",
                                      "text": "{0}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Starting",
                                      "representation": "pending",
                                      "text": "{0}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Stopped",
                                      "representation": "stopped",
                                      "text": "{0}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "warning",
                                      "text": "{0}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "httpListenersCount",
                                "formatter": 3,
                                "formatOptions": {
                                  "palette": "blue",
                                  "customColumnWidthSetting": "18ch"
                                }
                              },
                              {
                                "columnMatch": "backendPoolsCount",
                                "formatter": 3,
                                "formatOptions": {
                                  "palette": "green",
                                  "customColumnWidthSetting": "18ch"
                                }
                              },
                              {
                                "columnMatch": "requestRoutingRulesCount",
                                "formatter": 3,
                                "formatOptions": {
                                  "palette": "purple",
                                  "customColumnWidthSetting": "18ch"
                                }
                              },
                              {
                                "columnMatch": "wafMode",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Detection",
                                      "representation": "Info",
                                      "text": "{0}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Prevention",
                                      "representation": "Shield",
                                      "text": "{0}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "N√£o configurado",
                                      "representation": "disabled",
                                      "text": "{0}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Blank",
                                      "text": "{0}"
                                    }
                                  ]
                                }
                              }
                            ],
                            "filter": true,
                            "labelSettings": [
                              {
                                "columnId": "name",
                                "label": "Nome"
                              },
                              {
                                "columnId": "resourceGroup",
                                "label": "Grupo de Recursos"
                              },
                              {
                                "columnId": "location",
                                "label": "Regi√£o"
                              },
                              {
                                "columnId": "skuName",
                                "label": "SKU"
                              },
                              {
                                "columnId": "skuTier",
                                "label": "Tier"
                              },
                              {
                                "columnId": "capacity",
                                "label": "Capacidade"
                              },
                              {
                                "columnId": "operationalState",
                                "label": "Estado"
                              },
                              {
                                "columnId": "httpListenersCount",
                                "label": "Listeners"
                              },
                              {
                                "columnId": "backendPoolsCount",
                                "label": "Backend Pools"
                              },
                              {
                                "columnId": "requestRoutingRulesCount",
                                "label": "Regras"
                              },
                              {
                                "columnId": "wafMode",
                                "label": "WAF"
                              }
                            ]
                          }
                        },
                        "name": "query - appgw-list"
                      },
                      {
                        "type": 10,
                        "content": {
                          "chartId": "workbook70e6c4c0-2e31-4874-bb4b-a9f984975329",
                          "version": "MetricsItem/2.0",
                          "size": 0,
                          "chartType": 2,
                          "resourceType": "microsoft.network/applicationgateways",
                          "metricScope": 0,
                          "resourceParameter": "AppGateway",
                          "resourceIds": [
                            "{AppGateway}"
                          ],
                          "timeContextFromParameter": "timerange",
                          "timeContext": {
                            "durationMs": 3600000
                          },
                          "metrics": [
                            {
                              "namespace": "microsoft.network/applicationgateways",
                              "metric": "microsoft.network/applicationgateways--TotalRequests",
                              "aggregation": 1,
                              "splitBy": null,
                              "columnName": "Requisi√ß√µes"
                            },
                            {
                              "namespace": "microsoft.network/applicationgateways",
                              "metric": "microsoft.network/applicationgateways--FailedRequests",
                              "aggregation": 1,
                              "columnName": "Falhas"
                            }
                          ],
                          "title": "Requisi√ß√µes Totais vs. Falhas",
                          "showOpenInMe": true,
                          "showRefreshButton": true,
                          "gridSettings": {
                            "rowLimit": 10000
                          }
                        },
                        "conditionalVisibility": {
                          "parameterName": "AppGateway",
                          "comparison": "isNotEqualTo"
                        },
                        "customWidth": "50",
                        "name": "metric - appgw-requests"
                      },
                      {
                        "type": 10,
                        "content": {
                          "chartId": "workbook70e6c4c0-2e31-4874-bb4b-a9f984975330",
                          "version": "MetricsItem/2.0",
                          "size": 0,
                          "chartType": 2,
                          "resourceType": "microsoft.network/applicationgateways",
                          "metricScope": 0,
                          "resourceParameter": "AppGateway",
                          "resourceIds": [
                            "{AppGateway}"
                          ],
                          "timeContextFromParameter": "timerange",
                          "timeContext": {
                            "durationMs": 3600000
                          },
                          "metrics": [
                            {
                              "namespace": "microsoft.network/applicationgateways",
                              "metric": "microsoft.network/applicationgateways--ResponseStatus",
                              "aggregation": 1,
                              "splitBy": "HttpStatusGroup"
                            }
                          ],
                          "title": "C√≥digos de Status HTTP",
                          "showOpenInMe": true,
                          "showRefreshButton": true,
                          "gridSettings": {
                            "rowLimit": 10000
                          }
                        },
                        "conditionalVisibility": {
                          "parameterName": "AppGateway",
                          "comparison": "isNotEqualTo"
                        },
                        "customWidth": "50",
                        "name": "metric - appgw-status-codes"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "// HTTP Listeners\r\nresources\r\n| where type =~ 'microsoft.network/applicationgateways'\r\n| where id == '{AppGateway}'\r\n| mvexpand listener=properties.httpListeners\r\n| extend listenerName = tostring(listener.name)\r\n| extend protocol = tostring(listener.properties.protocol)\r\n| extend hostName = tostring(listener.properties.hostName)\r\n| extend frontendIPConfigId = tostring(listener.properties.frontendIPConfiguration.id)\r\n| extend frontendIPName = tostring(split(frontendIPConfigId, '/')[-1])\r\n| extend frontendPortId = tostring(listener.properties.frontendPort.id)\r\n| extend frontendPortName = tostring(split(frontendPortId, '/')[-1])\r\n| extend sslCertificateId = tostring(listener.properties.sslCertificate.id)\r\n| extend sslCertificateName = iff(isnotempty(sslCertificateId), tostring(split(sslCertificateId, '/')[-1]), 'Nenhum')\r\n| project listenerName, protocol, hostName, frontendIPName, frontendPortName, sslCertificateName\r\n| order by listenerName asc",
                          "size": 0,
                          "title": "HTTP Listeners",
                          "noDataMessage": "Selecione um Application Gateway para ver seus listeners",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "protocol",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Http",
                                      "representation": "Http",
                                      "text": "{0}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Https",
                                      "representation": "Https",
                                      "text": "{0}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Blank",
                                      "text": "{0}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "sslCertificateName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Nenhum",
                                      "representation": "cancelled",
                                      "text": "{0}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Certificate",
                                      "text": "{0}"
                                    }
                                  ]
                                }
                              }
                            ],
                            "filter": true,
                            "labelSettings": [
                              {
                                "columnId": "listenerName",
                                "label": "Nome"
                              },
                              {
                                "columnId": "protocol",
                                "label": "Protocolo"
                              },
                              {
                                "columnId": "hostName",
                                "label": "Hostname"
                              },
                              {
                                "columnId": "frontendIPName",
                                "label": "Frontend IP"
                              },
                              {
                                "columnId": "frontendPortName",
                                "label": "Porta"
                              },
                              {
                                "columnId": "sslCertificateName",
                                "label": "Certificado SSL"
                              }
                            ]
                          }
                        },
                        "conditionalVisibility": {
                          "parameterName": "AppGateway",
                          "comparison": "isNotEqualTo"
                        },
                        "customWidth": "50",
                        "name": "query - appgw-listeners"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "// Backend Pools\r\nresources\r\n| where type =~ 'microsoft.network/applicationgateways'\r\n| where id == '{AppGateway}'\r\n| mvexpand backend=properties.backendAddressPools\r\n| extend backendName = tostring(backend.name)\r\n| extend backends = array_length(iff(isnotempty(backend.properties.backendAddresses), backend.properties.backendAddresses, dynamic([])))\r\n| mvexpand backendAddress=backend.properties.backendAddresses\r\n| extend ipAddress = tostring(backendAddress.ipAddress)\r\n| extend fqdn = tostring(backendAddress.fqdn)\r\n| extend target = iff(isnotempty(fqdn), fqdn, ipAddress)\r\n| summarize Backends = make_set(target) by backendName\r\n| extend BackendCount = array_length(Backends)\r\n| extend BackendList = strcat_array(Backends, \", \")\r\n| project backendName, BackendCount, BackendList\r\n| order by backendName asc",
                          "size": 0,
                          "title": "Backend Pools",
                          "noDataMessage": "Selecione um Application Gateway para ver seus backend pools",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "BackendCount",
                                "formatter": 3,
                                "formatOptions": {
                                  "palette": "greenBlue",
                                  "customColumnWidthSetting": "18ch"
                                }
                              }
                            ],
                            "filter": true,
                            "labelSettings": [
                              {
                                "columnId": "backendName",
                                "label": "Nome"
                              },
                              {
                                "columnId": "BackendCount",
                                "label": "Qtd. Backends"
                              },
                              {
                                "columnId": "BackendList",
                                "label": "Backends"
                              }
                            ]
                          }
                        },
                        "conditionalVisibility": {
                          "parameterName": "AppGateway",
                          "comparison": "isNotEqualTo"
                        },
                        "customWidth": "50",
                        "name": "query - appgw-backends"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "SubTabNet",
                    "comparison": "isEqualTo",
                    "value": "AppGW"
                  },
                  "name": "group-network-appgw"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "TabMain",
              "comparison": "isEqualTo",
              "value": "Networking"
            },
            "name": "group-networking"
          }
        ]
      },
      "name": "group-main"
    }
  ],
  "fallbackResourceIds": [
    "Azure Monitor"
  ],
  "$schema": "https://github.com/Microsoft/Application-Insights-Workbooks/blob/master/schema/workbook.json"
}
